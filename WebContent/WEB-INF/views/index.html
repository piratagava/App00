<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
        <script src="http://code.jquery.com/jquery-1.11.1.min.js" rel="external"></script>
        <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js" rel="external"></script>
    	<script src="/resources/js/main.js"> </script>
    </head>

    <body>
        <!--Página Principal-->
        <div data-role="page" id="index">
            
            <!--Menú Lateral Principal-->
            <nav data-role="panel" id="menu" data-display="overlay">
                <h2>Men&uacute Principal</h2>
                <ul data-role="listview">
                    
                    <li data-role="list-divider">Alumnos</li>
                    <li><a href="alta_alumno">Dar de alta Alumno</a></li>
                    <li><a href="asignar_materias" id="registrar_alumno_materia">Asignar Materias</a></li>
                    <li><a href="#">Editar Alumno</a></li>

                    <li data-role="list-divider">Materias</li>
                    <li><a href="registrar_materia">Registrar Materia</a></li>
                    <li><a href="editar_materia" id="editar_materia">Editar Materia</a></li>
                </ul>
            </nav>
            
            <!--Encabezado-->
            <header data-role="header" data-theme="b">
                <a href="#menu" data-icon="bars" data-iconpos="notext"> </a>
                <h1>APP ID-00</h1>
            </header>    
            
            <!--Contenido-->
            <main data-role="content">
            	
            </main>


            <!--Pie de página-->
            <footer style="text-align:center" data-role="footer" data-theme="b" data-position="fixed" >
                <small>2019 &copy; APP'S </small>
                <br />
                <small>Application.</small>
            </footer>
        </div>
    </body>
    <script>
    'use strict'

    window.addEventListener('load', () => {
        
    });
    
    //consultarMateria
    let consultarMateria = (ruta) => {
    	fetch(ruta, {
    	    method : 'GET',
    	    headers : {
    	    	'Content-Type' : 'application/json'
    	    	}
    	    }).
    	    then(respuesta => {
    	    	return respuesta.json();
    	    }).then ((data) => {
    	    	desplegarMateria(data);
    	    }).
    	    catch(error => {
    	    	alert(error);
    	    });
    }
    
    let desplegarMateria = (materia) => {
    	/**
    	* Desplegará los datos de la materia, en el cual se mostrará el nombre de la materia y el número máximo de cupos
    	**/
    	document.getElementById("iptMateria").value = materia.nombre;
    	document.getElementById("iptNumMaxCupo").value = materia.numMaxCupo;
    	
    	//Envento actualizar materia
        
        let btnEditarMateria = document.querySelector("#btnEditarMateria");
    	btnEditarMateria.addEventListener('click', () => {
    		capturarDatosMateria("PUT")
    	});
        
    }
    
    let desplegarComboMaterias = (lstMaterias) => {
    	/**
    	* Desplegará las materias que esten registradas, las cuales se mostrarán en un compotente combox.
    	*/

    	let otnMateria = ``;
    	let i = 0;
    	
    	lstMaterias.forEach(materia => {
    		
    		if (i == 0) otnMateria += `<option value="0">SELECCIONE LA MATERIA.</option>`
			otnMateria += `<option value=${materia.id_materia}>${materia.nombre}</option>` 
    		i ++;
    	
    	});
    	
    	let comboMaterias = document.querySelector("#comboMaterias");
    	let sltMaterias = `<select>${otnMateria}</select>`;
    	comboMaterias.innerHTML = sltMaterias; 
    }
    
    
  
    //recibirDatosAlumnos
    let recibirDatosAlumnos = (ruta) => {
        fetch(ruta, {
            method : 'GET',
            headers : {
                'Content-Type' : 'application/json'
            }
        }).
        then(respuesta => {
            return respuesta.json();
        }).
            then(data => {
            desplegarAlumnos(data);
        }).
        catch(error => {
            alert(error);
        });
    }

    //desplegarAlumnos
    let desplegarAlumnos = (lstAlumnos) => {
        /**
        * Desplegará los alumnos que esten registrados en un componente combox.
        */
        let otnAlumno = ``;
        
        let i = 0 ;
        lstAlumnos.forEach(alumno => {
            if (i == 0)  otnAlumno += `<option value="0">SELECCIONE UN ALUMNO.</option>`
            let nombreCompleto = alumno.nombre + " " + alumno.apellidoPaterno + " " + alumno.apellidoMaterno;
            otnAlumno += `<option value="${alumno.id_alumno}">${nombreCompleto}</option>`
            i ++;
        });

        let sltAlumnos = `<select>${otnAlumno}</select>`;
        let comboAlumnos = document.querySelector("#comboAlumnos");
        comboAlumnos.innerHTML = sltAlumnos;
    }

    	</script>  
    </body>
</html>